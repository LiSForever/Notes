### 第二章 核心防御机制

#### 处理用户访问

* 身份验证
* 会话管理
  * 会话令牌
  * 会话终止
* 访问控制
  * 角色
  * 权限

#### 处理用户输入

* 输入的多样性
  * 在做过滤时要考虑用户的需求和安全性的平衡
* 输入处理方法
  * 黑名单
  * 白名单
  * 过滤和替换
  * 数据安全处理（参数格式化）
  * 合法的输入，非法的逻辑
* 边界检查
  * 不要试图根据每个模块的功能来针对输入做检查，每次数据进出模块时均做应做的检查

#### 应对攻击

* 正确处理程序的错误
* 维护审计日志
* 向管理员发出警告
  * 定义攻击行为，在疑似攻击行为发生时，向管理员发出警告
* 应对攻击
  * 确认攻击行为后，封禁账号、ip
  * 延缓攻击，要求验证码、减缓响应速度、断开连接重新登录

#### 管理应用程序

* CMS或者网站后台管理的安全性